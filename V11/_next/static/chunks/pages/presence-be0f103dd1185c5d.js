(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[543],{43318:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/presence",function(){return l(91163)}])},93503:(e,t,l)=>{"use strict";function r(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}l.d(t,{A:()=>r})},20068:(e,t,l)=>{"use strict";function r(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}l.d(t,{A:()=>r})},52496:(e,t,l)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}l.d(t,{A:()=>s});var n=l(93503);function s(e){(0,n.A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===r(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(Error().stack)),new Date(NaN))}},91163:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>v});var r=l(74848),n=l(96540),s=l(40350),a=l(93107),i=l(18322),o=l(6861),c=l(18382);l(77571);var d=l(59386),u=l.n(d),f=l(20757),h=l(20068),g=l(52496),x=l(93503);function b(e,t){(0,x.A)(2,arguments);var l=(0,g.A)(e),r=(0,h.A)(t);return isNaN(r)?new Date(NaN):(r&&l.setDate(l.getDate()+r),l)}let m=()=>{var e,t,l;let[d,g]=(0,n.useState)(!1),[m,v]=(0,n.useState)(!1),[p,N]=(0,n.useState)(!1),[y,E]=(0,n.useState)(new Date),[j,w]=(0,n.useState)([]),[S,_]=(0,n.useState)([]),[I,k]=(0,n.useState)([]),[D,A]=(0,n.useState)(),[O,F]=(0,n.useState)(),[T,M]=(0,n.useState)([]),[L,R]=(0,n.useState)(),[C,P]=(0,n.useState)("2025"),V=async(e,t)=>{if(j[t])j[t]&&(await (0,i.Wv)("/fraisitemeleve/".concat(T[t])),w(e=>{let l=[...e];return l[t]=!1,l}));else{let r={COUT_UNIT:O,QTE:1,DATE_FRAIS:(0,i.wj)(y),DATE_MODIF:"".concat(new Date),FRAIS_ITEM_ID:L,ELEVE_ID:e,USER_ID:Number(localStorage.getItem("id"))},{error:n}=await (0,i.sS)("/fraisitemeleve",!1,r);if(n){var l;alert(JSON.stringify(null===(l=n.response)||void 0===l?void 0:l.data));return}w(e=>{let l=[...e];return l[t]=!0,l})}},J=async(e,t)=>{var l,r,n,s,a,o,c,d,u,f,h,x,b,m;v(!0),A(e),F(t),N(!0),w([]),M([]);let{result:p}=await (0,i.Fd)("/fraisinscription/frais/".concat(e)),E=null!==(r=null==p?void 0:p.data)&&void 0!==r?r:null,j=null!==(n=null==p?void 0:p.error)&&void 0!==n?n:null;if(j){alert(JSON.stringify(null===(s=j.response)||void 0===s?void 0:s.data));return}let{result:S}=await (0,i.Fd)("/fraisitem/FraisItem/".concat(e)),I=null!==(a=null==S?void 0:S.data)&&void 0!==a?a:null,k=null!==(o=null==S?void 0:S.error)&&void 0!==o?o:null;if(k){alert(JSON.stringify(null===(c=k.response)||void 0===c?void 0:c.data));return}R(null===(l=I[0])||void 0===l?void 0:l.FRAIS_ITEM_ID);let D=null!==(d=null==E?void 0:E.map(e=>e.ELEVE_ID))&&void 0!==d?d:[];if(0===D.length){g(!1),N(!1);return}D.map(e=>{w(e=>{let t=[...e];return t.push(!1),t})});let{result:O,loading:T}=await (0,i.Fd)("/eleves",!1,{IDs:D,champs:["NOM","PRENOM"]}),L=null!==(u=null==O?void 0:O.data)&&void 0!==u?u:null,C=null!==(f=null==O?void 0:O.error)&&void 0!==f?f:null;if(C){alert(JSON.stringify(null===(h=C.response)||void 0===h?void 0:h.data));return}g(!0),_(null!=L?L:[]);let{result:P}=await (0,i.Fd)("/fraisitemeleve/FraisItem/".concat(I[0].FRAIS_ITEM_ID,"/datefrais/").concat((0,i.wj)(y))),V=null!==(x=null==P?void 0:P.data)&&void 0!==x?x:null,J=null!==(b=null==P?void 0:P.error)&&void 0!==b?b:null;if(J){alert(JSON.stringify(null===(m=J.response)||void 0===m?void 0:m.data));return}let U=[],X=[];(null!=L?L:[]).forEach(e=>{let t=null==V?void 0:V.find(t=>t.ELEVE_ID===e.ELEVE_ID);t?(U.push(!0),X.push(t.FRAIS_ITEM_ELEVE_ID)):(U.push(!1),X.push(null))}),w(U),M(X),N(T)};(0,n.useEffect)(()=>{let e=localStorage.getItem("annee");console.log(e),e&&P(e)},[]);let{result:U,loading:X}=(0,o.s)("/frais/typefrais/2",!1,{AnneeScolaire:C}),q=null!==(e=null==U?void 0:U.data)&&void 0!==e?e:null,z=null!==(t=null==U?void 0:U.error)&&void 0!==t?t:null;if(z){alert(JSON.stringify(null===(l=z.response)||void 0===l?void 0:l.data));return}return(0,r.jsxs)("div",{children:[(0,r.jsx)(s.A,{title:"Prise de pr\xe9sences"}),(0,r.jsx)(a.A,{currentpage:"Prise de pr\xe9sences",activepage:"Prise de pr\xe9sences",mainpage:""}),(0,r.jsxs)("div",{className:"flex gap-6",children:[(0,r.jsxs)("div",{className:"box w-1/3",children:[(0,r.jsx)("div",{className:"box-header",children:(0,r.jsx)("h5",{className:"box-title",children:"Liste des activit\xe9s"})}),(0,r.jsxs)("div",{className:"box-body flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"self-center flex gap-6 items-center",children:[(0,r.jsx)("button",{className:"ti-btn ti-btn-outline ti-btn-outline-light flex items-center",onClick:()=>{E(e=>(function(e,t){return(0,x.A)(2,arguments),b(e,-(0,h.A)(t))})(e,1)),A(null),_([])},children:(0,r.jsx)("i",{className:"ri-arrow-left-line text-2xl"})}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"px-4 inline-flex items-center min-w-fit ltr:rounded-l-sm rtl:rounded-r-sm border ltr:border-r-0 rtl:border-l-0 border-gray-200 bg-gray-50 dark:bg-black/20 dark:border-white/10",children:(0,r.jsx)("span",{className:"text-sm text-gray-500 dark:text-white/70",children:(0,r.jsx)("i",{className:"ri ri-calendar-line"})})}),(0,r.jsx)(u(),{className:"ti-form-input ltr:rounded-l-none rtl:rounded-r-none focus:z-10",locale:f.A,dateFormat:"dd/MM/yyyy",selected:y,onChange:e=>E(e)})]}),(0,r.jsx)("button",{className:"ti-btn ti-btn-outline ti-btn-outline-light flex items-center",onClick:()=>{E(e=>b(e,1)),A(null),_([])},children:(0,r.jsx)("i",{className:"ri-arrow-right-line text-2xl"})})]}),X&&(0,r.jsx)(c._N,{}),!X&&(0,r.jsxs)("ul",{className:"w-full flex flex-col",children:[q&&0===q.length&&(0,r.jsx)("li",{children:"Aucun activit\xe9 pour ce jour"}),q&&q.length>0&&(null==q?void 0:q.map(e=>(0,r.jsx)("li",{className:"ti-list-group gap-x-3.5 bg-white text-gray-800 dark:bg-bgdark \n                                dark:border-white/10 dark:text-white\n                                ".concat(D===e.FRAIS_ID?"!bg-primary text-white":""),onClick:()=>J(e.FRAIS_ID,e.MONTANT),children:e.LIBELLE},e.FRAIS_ID)))]})]})]}),(0,r.jsxs)("div",{className:"box w-2/3",children:[(0,r.jsx)("div",{className:"box-header",children:(0,r.jsx)("h5",{className:"box-title",children:"Liste des enfants"})}),p&&m&&(0,r.jsx)("div",{className:"box-body",children:(0,r.jsx)(c._N,{})}),!p&&(0,r.jsxs)("div",{className:d?"box-body":"box-body h-full flex items-center justify-center",children:[!d&&m&&(0,r.jsx)("p",{children:"Aucun enfant inscrit \xe0 cette activit\xe9"}),d&&m&&(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsx)("ul",{className:"flex flex-col gap-3",children:S.map((e,t)=>(0,r.jsx)("li",{className:"ti-list-group gap-x-3.5 bg-white text-gray-800 dark:bg-bgdark dark:border-white/10 dark:text-white",children:(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"switch-".concat(e.ELEVE_ID),className:"ti-switch shrink-0 checked:bg-none checked:bg-green-600 checked:hover:bg-green-600 checked:focus:bg-green-600 focus:border-green-600 focus:ring-green-600 dark:checked:bg-green-600 checked:before:bg-green-200 dark:checked:before:bg-green-200",onChange:()=>V(e.ELEVE_ID,t),checked:j[t]}),(0,r.jsxs)("p",{className:"w-full text-left",children:[e.NOM," ",e.PRENOM]})]})},e.ELEVE_ID))})})]})]})]})]})};m.layout="Contentlayout";let v=m}},e=>{var t=t=>e(e.s=t);e.O(0,[374,833,718,150,552,923,636,593,792],()=>t(43318)),_N_E=e.O()}]);