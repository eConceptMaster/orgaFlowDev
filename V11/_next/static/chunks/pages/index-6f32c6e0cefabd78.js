(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{92022:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(73275)}])},73275:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>N});var r=n(74848),a=n(40350),i=n(96540),o=n(85902),s=n(18940),l=n(94335),c=n(18987),u=n(86715),m=n(29965),d=n.n(m),E=n(95977);let A={src:"/orgaFlowDev/V11/_next/static/media/2.5333b144.png",height:512,width:512,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAclBMVEVMaXGU3dWX5diT5cax7tyBSB+V2MqNURu0fCGW2caL0KKA2cBo0cC7nlp2wsKkllXOiR+EtbWQ3cOkeDBuPhuq6NeS3c+s1s9rRCeNe1OKj3m1fSGzyZRoeWaW1tKHopB+qpCNVRq36duqcBd+z8nIgxBzAmjcAAAAI3RSTlMA/Isy8nHfX+heC3s9LcKBkuIetErkwP40m/y3ue3z+/2HR6HEAasAAAAJcEhZcwAACxMAAAsTAQCanBgAAABCSURBVHicY2CAASUxTiEuTmYGBiYVNlE2FhZuBiZGOUZxQT4eBhkFWXkpSX5eBmlVDmUOYQ4BBnZFCVZ2EVZ2uG4AZ1oC+US8QPUAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},g=()=>navigator.onLine,I=()=>{alert("No internet connection. Please check your network and try again.")},p=()=>{var e,t;let n=(0,u.useRouter)(),[m,p]=(0,i.useState)(!1),[N,b]=i.useState({MAIL:"",PASSWORD:"",TEL:void 0}),h=window.navigator.userAgent.toLowerCase(),z=e=>{let{name:t,value:n}=e.target;b(e=>({...e,[t]:n})),p(!1)},S=e=>{"Enter"===e.key&&T()},T=async()=>{try{if(!g()){I();return}if(!s.LB.safeParse(N).success){p(!0);return}let e=await l.A.post("".concat("https://rest.econcept.be","/compteutilisateur/Connexion"),N,{headers:{Secret:"EcoleEnPoche"}});if(200!==e.status&&alert(JSON.stringify(e.data)),200===e.status){let t={"X-Embarcadero-Tenant-Id":e.data.INFOS_CONNEXION[0].TENANT_ID,"X-Embarcadero-Tenant-Secret":e.data.INFOS_CONNEXION[0].TENANT_SECRET},r="https://".concat(e.data.INFOS_CONNEXION[0].IP);if(!g()){I();return}let a={username:e.data.ID,password:N.PASSWORD},i=await l.A.post("".concat(r,"/users/login"),a,{headers:t});if(200!==i.status){alert(JSON.stringify(i.data));return}if(200===i.status){localStorage.setItem("id",e.data.ID),c.A.set("tenant-id",e.data.INFOS_CONNEXION[0].TENANT_ID,{path:"/",secure:!0,sameSite:"strict"}),c.A.set("tenant-secret",e.data.INFOS_CONNEXION[0].TENANT_SECRET,{path:"/",secure:!0,sameSite:"strict"}),c.A.set("secret","EcoleEnPoche",{path:"/",secure:!0,sameSite:"strict"}),c.A.set("ip",r,{path:"/",secure:!0,sameSite:"strict"}),c.A.set("session-token",i.data.sessionToken,{path:"/",secure:!0,sameSite:"strict",expires:new Date(new Date().getTime()+24e5)});let a=(0,E.w)(),o=await a.get("/params/annee",{headers:t});localStorage.setItem("annee",o.data.VALEUR),h.includes("win")?localStorage.setItem("os","win"):h.includes("mac")?localStorage.setItem("os","mac"):h.includes("linux")?localStorage.setItem("os","linux"):localStorage.setItem("os","other"),await n.push("/dashboard")}}}catch(e){p(!0),console.error(e)}};return(0,r.jsxs)("div",{className:"flex justify-center min-h-screen align-middle",children:[(0,r.jsx)(a.A,{title:"Login"}),(0,r.jsxs)(o.vd,{children:[(0,r.jsx)(o.mg,{children:(0,r.jsx)("body",{className:"cover2 justify-center"})}),(0,r.jsxs)("main",{id:"content",className:"w-full mx-auto my-auto p-6 flex justify-evenly items-center",children:[(0,r.jsx)("span",{className:"header-logo w-1/3",children:(0,r.jsx)(d(),{src:A,alt:"auth image",placeholder:"blur",width:A.width,height:A.height,unoptimized:!0})}),(0,r.jsx)("div",{className:"border-r border-white w-[1px] h-96"}),(0,r.jsxs)("div",{className:"w-1/3",children:[(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("h1",{className:"block text-6xl font-bold text-white",children:(0,r.jsx)("i",{className:"ri-user-line"})})}),(0,r.jsxs)("div",{className:"mt-5",children:[m&&(0,r.jsxs)("p",{className:"border-red-800 border bg-red-300 p-5 rounded-sm text-red-800 mb-6",children:["Votre adresse mail ou mot de passe n'est pas correct.","Veuillez les corriger."]}),(0,r.jsxs)("form",{className:"grid gap-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm mb-2 text-white",children:"Adresse mail"}),(0,r.jsx)("input",{type:"text",autoFocus:!0,value:null!==(e=N.MAIL)&&void 0!==e?e:"",onChange:z,onKeyDown:S,id:"email",name:"MAIL",className:"py-2 px-3 block w-full !bg-white/45 rounded-sm text-black text-sm focus:border-primary focus:ring-primary"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm mb-2 text-white",children:"Mot de passe"})}),(0,r.jsx)("input",{type:"password",id:"password",name:"PASSWORD",value:null!==(t=N.PASSWORD)&&void 0!==t?t:"",onKeyDown:S,onChange:z,className:"py-2 px-3 block w-full !bg-white/45 rounded-sm text-black text-sm focus:border-primary focus:ring-primary"})]}),(0,r.jsx)("button",{type:"button",onClick:T,className:"py-2 px-3 inline-flex justify-center items-center gap-2 rounded-sm border border-transparent font-semibold bg-secondary text-white hover:bg-primary focus:outline-none focus:ring-0 focus:ring-primary focus:ring-offset-0 transition-all text-sm dark:focus:ring-offset-white/10",children:"Se connecter"})]})]})]})]})]})]})};p.layout="Authenticationlayout";let N=p},40350:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(74848);n(96540);var a=n(13368),i=n.n(a);let o={src:"/orgaFlowDev/V11/_next/static/media/favicon.ab2d95a1.ico"},s=e=>{let{title:t}=e;return(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:"".concat(t)}),(0,r.jsx)("link",{href:o.src,rel:"icon"}),(0,r.jsx)("meta",{name:"description",content:"Synto - Nextjs Admin & Dashboard Template"}),(0,r.jsx)("meta",{name:"author",content:"Spruko Technologies Private Limited"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,r.jsx)("meta",{name:"keywords",content:"tailwind nextjs, dashboard tailwind, tailwind admin, nextjs tailwind, tailwind in nextjs, admin dashboard tailwind, tailwind dashboards, tailwind template admin, tailwind and nextjs, admin panel, template dashboard, admin dashboard template, admin panel template"})]})}},18940:(e,t,n)=>{"use strict";n.d(t,{EY:()=>c,JO:()=>u,LB:()=>i,Sg:()=>l,UG:()=>s,Yo:()=>E,iR:()=>o});var r=n(18322),a=n(14476);let i=a.z.object({MAIL:a.z.string().min(1),TEL:a.z.string().optional(),PASSWORD:a.z.string()}),o=a.z.object({MAIL:a.z.string().email().optional(),TELEPHONE:a.z.number().refine(e=>{let t=e.toString();return!(t.length<3)&&(0,r.Q7)("+".concat(t))},{message:"Le num\xe9ro doit contenir au moins 3 chiffres et \xeatre valide avec l'indicatif du pays.,"}),PASSWORD:a.z.string().min(1),TYPE_USER:a.z.number().min(1),FLAG_MAIL_VERIFIED:a.z.number().optional(),FLAG_TELEPHONE_VERIFIED:a.z.number().optional(),DATETIME_CREATION:a.z.string().datetime().min(1),CODE_PIN:a.z.number().optional()}),s=a.z.object({ID:a.z.number().optional(),NOM:a.z.string().min(1),PRENOM:a.z.string().optional(),REGISTRE_NATIONAL:a.z.string().optional(),TYPE_CIVILITE:a.z.number().refine(e=>e>=0&&e<=2,{message:"Vous devez choisir un genre"}),NUMERO_RESPONSABLE:a.z.number(),UID:a.z.string().min(1),TELEPHONE:a.z.number().refine(e=>{let t=e.toString();return(0,r.Q7)("+".concat(t))},{message:"Le num\xe9ro doit \xeatre valide avec le format du pays."}),MAIL:a.z.string().email().optional()});a.z.object({username:a.z.string().min(1),password:a.z.string().min(1)});let l=a.z.object({NOM:a.z.string().min(1),ELEVE_ID:a.z.number().optional(),PRENOM:a.z.string().optional(),SEXE_TYPE:a.z.string().min(1),LIEU_NAISSANCE:a.z.string().min(1),CODE_PAYS_NAIS:a.z.string().optional(),NAISSANCE_DATE:a.z.string().datetime({local:!0}).min(1),CODE_NATIONALITE:a.z.string().optional(),NISS:a.z.string().optional(),TELEPHONE:a.z.string().optional().refine(e=>!e||e.length<3||(0,r.Q7)("+".concat(e)),{message:"le num\xe9ro doit contenir au moins 3 chiffres et быть valide avec l'indicatif du pays."})}),c=a.z.object({ADRESSE_ID:a.z.number().optional(),ELEVE_ID:a.z.number().optional(),RESPONSABLE_ID:a.z.number().optional(),ADRESSE:a.z.string().min(1),NUMERO:a.z.string().min(1),CODE_POSTAL:a.z.number().min(4).nullable(),LOCALITE:a.z.string().min(1),NUM_BOITE:a.z.string().optional(),CODE_POSTAL2:a.z.string().optional()}),u=a.z.object({LIBELLE:a.z.string().min(1),MONTANT:a.z.number().min(1).nullable(),ANNEE_SCOLAIRE:a.z.number().min(1),TYPE_FRAIS:a.z.number().min(0),DATE_FRAIS:a.z.string().optional(),DATE_ECHEANCE:a.z.string().datetime().optional(),DATE_FRAIS_FIN:a.z.string().datetime().optional(),FRAIS_ID:a.z.number().optional(),CATEGORIE_ID:a.z.number()});a.z.object({FRAIS_INSCRIPTION_ID:a.z.number().optional(),ELEVE_ID:a.z.number(),FRAIS_ID:a.z.number(),DATE_INSCRIPTION:a.z.string().datetime({local:!0}),DATE_DEPART:a.z.string().datetime({local:!0}).optional()}),a.z.object({FRAIS_ITEM_ID:a.z.number().optional(),FRAIS_PARENT_ID:a.z.number().optional(),LIBELLE:a.z.string().optional(),PRIX:a.z.number().optional()}),a.z.object({FRAIS_ITEM_ELEVE_ID:a.z.number().optional(),FRAIS_ITEM_ID:a.z.number().optional(),ELEVE_ID:a.z.number().optional(),QTE:a.z.number().optional(),COUT_UNIT:a.z.number(),COUT_TOTAL:a.z.number().optional(),DATE_FRAIS:a.z.string().datetime({local:!0}),DATE_MODIF:a.z.string().optional(),USER_ENCODE:a.z.string().optional(),USER_ID:a.z.number().optional(),PROF_ID:a.z.string().optional()});let m=a.z.object({ELEVE_ID:a.z.number().optional(),FRAIS_ID:a.z.number(),LIBELLE:a.z.string(),COUT_TOTAL:a.z.number(),COMMUNICATION_STRUCTUREE:a.z.string().optional()}),d=a.z.object({ELEVE_ID:a.z.number(),FRAIS_ITEM:a.z.array(m)});a.z.array(d),a.z.object({COUT_TOTAL:a.z.number(),MONTANT_PAYE:a.z.number(),BALANCE:a.z.number()}),a.z.object({ELEVE_ID:a.z.number(),COUT_TOTAL:a.z.number(),MONTANT_PAYE:a.z.number(),BALANCE:a.z.number()}),a.z.object({ELEVE_ID:a.z.number(),FRAIS_ID:a.z.number(),LIBELLE:a.z.string(),DATE_FRAIS:a.z.string().datetime({local:!0})}),a.z.object({ID:a.z.number(),REFERENCE:a.z.string(),ID_REFERENCE:a.z.string(),LIBELLE_REFERENCE:a.z.string()});let E=a.z.object({FRAIS_PAIEMENT_ID:a.z.number().optional(),ELEVE_ID:a.z.number(),MONTANT:a.z.number().optional(),TYPE_PAIEMENT:a.z.number(),DATE_PAIEMENT:a.z.string().datetime({local:!0}),FRAIS_ID:a.z.number(),REMARQUE:a.z.string(),FLG_REMBOURSEMENT:a.z.number(),EXTRAIT_ID:a.z.number(),ANNEE_SCOLAIRE:a.z.number(),PARENT_PAIEMENT_ID:a.z.number(),TRANSFERT_LIER_ID:a.z.number(),MODULE_TYPE_TRANSFERT:a.z.number()})},86857:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(94335),a=n(18987),i=n(18322);new AbortController;let o=r.A.create({baseURL:"https://rest.econcept.be"});o.interceptors.request.use(async e=>{await (0,i.RI)();let t=a.A.get("secret");return t&&(e.headers.Secret=t),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>((0,i.cH)(),e),e=>Promise.reject(e));let s=o},95977:(e,t,n)=>{"use strict";n.d(t,{w:()=>l});var r=n(18987),a=n(94335),i=n(18322);let o=null,s=new AbortController,l=()=>{if(!o){let e=r.A.get("ip");if(!e)throw window.location.href="/",Error("IP non d\xe9finie dans les cookies.");(o=a.A.create({baseURL:e})).interceptors.request.use(async e=>{try{if(!await (0,i.RI)())return Promise.reject(Error("No session token"));let t=r.A.get("session-token"),n=r.A.get("tenant-id"),a=r.A.get("tenant-secret");return t&&(e.headers["X-Embarcadero-Session-Token"]=t),n&&(e.headers["X-Embarcadero-Tenant-Id"]=n),a&&(e.headers["X-Embarcadero-Tenant-Secret"]=a),e.signal=s.signal,e}catch(e){return Promise.reject(e)}},e=>Promise.reject(e)),o.interceptors.response.use(e=>((0,i.cH)(),e),e=>Promise.reject(e))}return o}},18322:(e,t,n)=>{"use strict";n.d(t,{FI:()=>T,Fd:()=>b,LS:()=>z,Q7:()=>g,RI:()=>N,We:()=>d,Wv:()=>S,Ys:()=>E,ZH:()=>w,cH:()=>p,eV:()=>_,fk:()=>A,sS:()=>h,wj:()=>I});var r=n(87e3),a=n(18987),i=n(86715),o=n.n(i),s=n(95977),l=n(86857);let c=()=>navigator.onLine,u=()=>{alert("No internet connection. Please check your network and try again.")},m=r.PhoneNumberUtil.getInstance(),d=e=>"".concat(e[0]).concat(e.slice(1).toLowerCase()),E=e=>{let t=new Date(e),n=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0");return"".concat(n,"/").concat(r,"/").concat(t.getFullYear())},A=e=>{try{let t=m.parse("+".concat(e)),n=m.format(t,r.PhoneNumberFormat.INTERNATIONAL);return"".concat(n)}catch(e){return console.error(e),""}},g=e=>{try{return m.isValidNumber(m.parseAndKeepRawInput(e))}catch(e){return!1}},I=e=>e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())).toISOString():new Date(Date.UTC(new Date().getFullYear(),new Date().getMonth(),new Date().getDate())).toISOString(),p=()=>{let e=a.A.get("session-token");e&&a.A.set("session-token",e,{path:"/",secure:!0,sameSite:"strict",expires:new Date(new Date().getTime()+24e5)})},N=async()=>!!a.A.get("session-token")||(await o().replace("/"),!1),b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json";try{if(!c())return u(),{result:{data:null,error:{message:"No internet connection"}},loading:!1};let a=new URLSearchParams;n&&Object.entries(n).forEach(e=>{let[t,n]=e;Array.isArray(n)||"object"==typeof n?a.append(t,JSON.stringify(n)):a.append(t,n)});let i={responseType:r},o="".concat(e,"?").concat(a.toString()),m=(0,s.w)();return{result:{data:(t?await (0,l.A)(o,i):await m(o,i)).data,error:null},loading:!1}}catch(e){return{result:{data:null,error:e},loading:!1}}},h=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;try{if(!c())return u(),{data:null,error:{message:"No internet connection"}};let r=(0,s.w)();return{data:(t?await l.A.put(e,n):await r.put(e,n)).data,error:null}}catch(e){return{data:null,error:e}}},z=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;try{if(!c())return u(),{data:null,error:{message:"No internet connection"}};let r=(0,s.w)();return{data:(t?await l.A.post(e,n):await r.post(e,n)).data,error:null}}catch(e){return{data:null,error:e}}},S=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{if(!c())return u(),{data:null,error:{message:"No internet connection"}};let n=(0,s.w)();return{data:(t?await l.A.delete(e):await n.delete(e)).data,error:null}}catch(e){return{data:null,error:e}}},T=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;try{if(!c())return u(),{data:null,error:{message:"No internet connection"}};let r=(0,s.w)();return{data:(t?await l.A.patch(e,n):await r.patch(e,n)).data,error:null}}catch(e){return{data:null,error:e}}},_=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase():"",w=e=>{if(!(e instanceof Date)||isNaN(e.getTime()))throw Error("Date invalide pass\xe9e \xe0 extractMonthDays");return{FirstDayOfMonth:I(new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)),LastDayOfMonth:I(new Date(e.getFullYear(),e.getMonth()+1,0,23,59,59,999))}}}},e=>{var t=t=>e(e.s=t);e.O(0,[374,718,476,965,636,593,792],()=>t(92022)),_N_E=e.O()}]);